    <div class="d-flex justify-content-center align-items-center">
        <span role="img" class="anticon"><svg width="713" height="77" viewBox="0 0 713 77" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M690.33 66.0595L668.254 65.5144L624.375 64.6968C607.75 64.4242 591.397 64.1517 574.772 63.8791C575.862 63.6066 576.952 63.334 577.77 63.0615C588.944 59.791 604.752 51.3421 613.473 61.1537C596.03 41.8031 557.602 77.2337 546.973 53.795C546.428 58.7008 548.063 61.6988 550.788 63.334C545.883 63.334 541.249 63.334 536.343 63.0615C534.436 63.0615 532.528 63.0615 530.62 63.0615C537.434 58.4283 542.339 50.797 551.333 51.6147C561.145 52.4323 574.772 59.5184 585.674 53.795C580.495 55.7028 573.137 52.7048 569.049 49.1618C567.141 47.5265 564.688 44.256 561.69 44.8011C558.692 45.0736 559.237 48.6167 560.327 51.3421C542.885 44.8011 532.255 58.1557 523.261 63.334C519.718 63.334 515.903 63.334 512.36 63.334H512.087C509.089 63.334 506.091 63.334 503.366 63.334C505.819 61.4262 507.999 58.9733 509.634 55.7028C511.27 52.1598 517.811 44.8011 521.626 50.5245C518.628 48.6167 511.27 51.3421 511.27 55.7028C511.27 61.4262 518.083 61.1537 521.626 60.0635C526.259 58.4283 529.257 53.2499 531.71 48.6167C534.163 44.256 537.979 37.4424 538.251 32.5366C531.438 40.1679 522.716 41.5306 513.722 43.4384C510.452 44.256 506.364 44.8011 504.183 48.0716C502.548 50.5245 502.548 57.8832 506.909 55.4303C505.274 58.4283 502.276 60.8811 498.46 62.7889C497.642 63.0615 497.097 63.334 496.28 63.334C494.099 63.334 491.646 63.334 489.466 63.334C488.921 63.0615 488.376 63.0615 487.831 62.7889C485.105 61.6988 480.745 56.5205 478.292 57.8832C480.2 59.5184 481.562 61.6988 483.47 63.334C471.751 63.334 459.759 63.0615 448.039 63.0615H443.679C445.587 60.6086 446.949 57.0655 446.677 54.3401C444.496 58.1557 442.044 61.4262 438.5 63.0615H418.332C412.881 60.0635 415.879 49.7069 421.875 47.254C416.697 48.3442 414.789 51.6147 412.336 56.2479C410.701 59.791 408.521 61.6988 406.068 62.7889H388.898C397.619 61.4262 403.615 55.4303 410.701 48.8892C411.791 48.0716 412.881 46.9814 413.972 46.4364C414.789 45.8913 416.697 45.0736 418.877 44.256C427.326 41.8031 442.316 40.1679 438.773 51.3421C438.5 51.6147 438.773 51.3421 438.5 51.6147C435.503 43.1658 424.328 43.4384 423.511 51.3421C422.42 59.791 433.867 60.0635 437.683 56.5205C439.318 55.1577 440.408 53.5225 441.226 52.1598C444.224 48.0716 443.134 42.3482 438.5 38.5326C434.14 34.9895 429.234 34.4445 424.601 35.5346C439.046 27.3583 451.583 32.8092 463.847 43.4384C462.484 42.6207 459.759 40.9855 455.943 39.3502C453.218 37.715 450.765 36.3523 443.679 35.8072L455.126 41.258C450.492 42.0757 446.677 48.3442 452.673 53.795C464.665 64.6968 476.657 50.5245 491.646 55.4303C483.47 48.8892 483.198 39.3502 476.384 31.9916C475.294 30.6288 472.841 28.4485 472.023 27.9034C467.935 25.4505 463.302 28.9936 463.029 33.6268C462.757 36.6248 464.12 38.8051 465.755 40.4404C453.763 28.9936 438.228 25.7231 426.781 32.8092C428.961 29.5387 430.324 27.0858 433.05 24.3604C433.05 24.3604 438.228 25.9956 443.406 22.9976C451.855 17.8193 452.128 8.55284 457.306 0.376547C449.13 5.00978 437.138 -1.53126 431.687 8.00776C427.054 15.9115 430.052 24.6329 425.418 32.5366L421.603 36.6248C420.785 36.8973 419.968 37.4424 419.15 37.9875C417.242 39.0777 415.607 40.4404 413.972 42.0757C412.336 43.1658 408.248 41.8031 407.158 39.6228C405.795 36.8973 408.521 36.6248 414.789 34.4445C418.332 33.0817 419.695 32.8092 422.966 24.3604C416.97 27.6309 409.883 22.4526 404.705 29.5387C399.254 37.1699 404.433 42.6207 410.974 44.5285C410.428 45.3462 409.883 45.8913 409.338 46.7089C408.793 47.254 408.248 47.7991 407.431 48.3442C404.978 50.252 401.98 51.8872 399.527 51.6147C398.437 51.6147 397.619 51.3421 396.801 51.0696C396.801 50.5245 396.801 50.252 396.801 49.7069C396.529 46.9814 395.711 44.8011 394.348 42.6208C392.986 40.7129 391.35 39.0777 389.715 37.9875C386.172 35.5346 382.629 33.8994 378.813 32.8092C371.182 30.6288 363.279 30.0838 355.647 30.9014C363.279 31.719 370.637 33.3543 377.451 36.3523C380.721 37.715 383.992 39.6228 386.445 42.0757C387.807 43.1658 388.898 44.5285 389.715 45.8913C389.988 46.4364 390.26 47.254 390.533 47.7991C388.625 47.254 385.9 47.5265 381.539 49.1618C384.537 49.7069 386.445 50.797 387.262 52.4323C386.717 52.4323 385.9 52.7048 385.355 52.7048C381.811 53.2499 377.723 53.2499 373.908 54.0676C369.82 54.8852 365.731 56.2479 362.188 58.4283C360.008 59.791 357.828 61.4262 356.192 63.6066C354.285 61.6988 352.377 59.791 349.924 58.4283C346.108 56.2479 342.02 54.8852 337.932 54.0676C333.844 53.2499 330.028 53.2499 326.485 52.7048C325.94 52.7048 325.395 52.4323 324.85 52.4323C325.668 50.797 327.303 49.7069 330.573 49.1618C326.213 47.254 323.487 47.254 321.307 48.0716C321.852 45.8913 323.487 43.9835 325.395 42.0757C327.848 39.6228 331.118 37.9875 334.389 36.3523C341.203 33.3543 348.561 31.719 356.192 30.9014C348.561 30.0838 340.657 30.6288 333.026 32.8092C329.211 33.8994 325.395 35.5346 322.125 37.9875C320.489 39.3502 318.854 40.7129 317.491 42.6208C316.129 44.5286 315.311 46.9814 315.038 49.4343C315.038 49.7069 315.038 50.252 315.038 50.797C314.221 51.0696 313.676 51.3421 312.586 51.3421C310.133 51.3421 307.135 49.9794 304.682 48.0716C304.137 47.5265 303.592 46.9814 302.774 46.4364C302.229 45.6187 301.411 45.0736 301.139 44.256C307.68 42.3482 313.131 36.8973 307.407 29.2661C302.229 22.18 295.143 27.6309 289.147 24.0878C292.69 32.5366 293.78 32.8092 297.323 34.1719C303.592 36.3523 306.044 36.8973 304.954 39.3502C303.864 41.5306 300.049 43.1658 298.141 41.8031C296.505 40.4404 294.87 39.0777 292.962 37.715C292.145 37.1699 291.327 36.6248 290.509 36.3523L286.694 32.2641C282.061 24.3604 285.059 15.639 280.425 7.73521C274.702 -1.8038 262.983 4.4647 254.806 0.104004C259.985 8.2803 260.257 17.5468 268.706 22.7251C273.884 25.7231 279.063 24.0878 279.063 24.0878C281.516 26.8132 282.878 29.2661 285.331 32.5366C274.157 25.4505 258.622 28.721 246.358 40.1679C247.993 38.2601 249.355 36.0797 249.083 33.3543C248.538 28.721 244.177 25.178 240.089 27.6309C238.999 28.176 236.818 30.3563 235.728 31.719C228.642 39.0777 228.642 48.6167 220.466 55.1577C235.456 50.252 247.448 64.1517 259.44 53.5225C265.163 48.3442 261.62 42.0757 256.987 40.9855L268.434 35.5346C261.075 36.0797 258.622 37.4424 256.169 39.0777C252.353 40.7129 249.901 42.0757 248.265 43.1658C260.53 32.5366 273.067 26.8132 287.512 35.2621C282.878 33.8994 277.973 34.717 273.612 38.2601C268.706 42.0757 267.888 47.7991 270.886 51.8872C271.704 53.2499 272.794 54.6127 274.429 56.2479C278.518 59.791 289.692 59.5184 288.602 51.0696C287.512 43.1658 276.61 42.6207 273.612 51.3421C273.339 51.0696 273.612 51.3421 273.339 51.0696C269.524 39.8953 284.786 41.258 293.235 43.9835C295.415 44.8011 297.051 45.6187 298.141 46.1638C299.231 46.9814 300.321 47.7991 301.411 48.6167C308.497 55.1577 314.493 61.4262 323.215 62.5164H306.044C303.592 61.4262 301.684 59.5184 299.776 55.9754C297.596 51.0696 295.688 48.0716 290.237 46.9814C296.233 49.4343 298.958 59.5184 293.78 62.7889H273.612C270.069 61.1537 267.616 57.8832 265.436 54.0676C265.163 56.793 266.253 60.3361 268.434 62.7889H264.073C252.353 62.7889 240.362 63.0615 228.642 63.0615C230.55 61.4262 231.913 59.2459 233.821 57.6106C231.368 56.2479 227.007 61.1537 224.281 62.5164C223.736 62.7889 223.191 63.0615 222.646 63.0615C220.466 63.0615 218.013 63.0615 215.833 63.0615C215.288 62.789 214.47 62.7889 213.652 62.5164C210.109 60.6086 206.839 58.1557 205.203 55.1577C209.564 57.3381 209.564 50.252 207.929 47.7991C205.749 44.5286 201.933 43.9835 198.39 43.1658C189.396 41.258 180.675 39.8953 173.861 32.2641C173.861 37.1699 177.949 43.9835 180.402 48.3442C182.855 52.9774 185.853 57.8832 190.486 59.791C194.029 61.1537 200.843 61.4262 200.843 55.4303C200.843 51.0696 193.484 48.3442 190.486 50.252C194.302 44.5286 200.57 51.8872 202.478 55.4303C204.113 58.7008 206.294 61.4262 208.747 63.0615C205.749 63.0615 202.751 63.0615 200.025 63.0615H199.753C196.21 63.0615 192.394 63.0615 188.851 63.0615C179.857 57.8832 169.228 44.5286 151.785 51.0696C153.148 48.3442 153.42 45.0736 150.422 44.5285C147.152 43.9835 144.699 47.254 143.064 48.8892C138.975 52.7048 131.617 55.7028 126.438 53.5225C137.34 59.2459 151.24 52.1598 160.779 51.3421C169.773 50.5245 174.951 58.1557 181.492 62.7889C179.584 62.7889 177.677 62.7889 175.769 62.7889C170.863 62.7889 166.23 62.789 161.324 63.0615C164.049 61.1537 165.685 58.1557 165.14 53.5225C154.51 76.9612 116.082 41.258 98.6391 60.8811C107.36 50.797 123.168 59.5184 134.342 62.7889C135.16 63.0615 136.25 63.334 137.34 63.6066C120.715 63.8791 104.362 64.1517 87.7373 64.4242L44.1304 65.5144L22.0544 66.0595L0.250977 66.6046L22.327 67.1496L44.403 67.6947L88.2824 68.5124C117.717 69.0574 146.879 69.33 176.314 69.8751C205.749 70.1476 234.911 70.4202 264.345 70.6927L343.655 70.9652L333.299 66.332C330.846 64.6967 328.12 61.9713 326.485 58.9733C330.301 59.5184 333.844 60.0635 337.114 60.8811C340.657 61.6988 343.928 62.789 346.653 64.4242C349.379 66.0595 351.559 68.5124 353.194 71.5103L356.192 76.9612L359.463 71.7829C361.371 69.0574 363.551 66.6046 366.277 64.6968C369.002 62.789 372.272 61.6988 375.816 60.8811C379.086 60.0635 382.629 59.5184 386.717 58.9733C385.082 61.6988 382.357 64.4242 379.904 66.332L369.547 70.9652L448.857 70.6927C478.292 70.4202 507.454 70.4202 536.889 69.8751C566.323 69.6025 595.485 69.0574 624.92 68.5124L668.799 67.6947L690.875 67.1496L712.951 66.6046L690.33 66.0595Z"
                    fill="url(#paint0_linear_204_295)" fill-opacity="0.8"></path>
                <defs>
                    <linearGradient id="paint0_linear_204_295" x1="186.725" y1="20.6343" x2="604.321"
                        y2="257.749" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#A2DA00"></stop>
                        <stop offset="1" stop-color="#93C600"></stop>
                    </linearGradient>
                </defs>
            </svg>
        </span>
    </div>

    <div class="container py-5 dream-container">
        <h2 class="text-center mb-5 fw-bold text-gradient">ğŸŒ™ Dream Explorer</h2>

        <!-- Search Section -->
        {{-- <div class="row mt-4 justify-content-center">
            <div class="col-lg-8">
                <div class="input-group shadow rounded-pill overflow-hidden">
                    <input type="text" id="searchInput" class="form-control border-0 ps-4"
                        placeholder="ğŸ” Search dreams...">
                    <button class="btn btn-secondary px-4" id="searchBtn">Search</button>
                </div>

                <div id="searchError" class="custom-error mt-3" style="display:none;">
                    <span class="icon">ğŸ˜¢</span>
                    <span id="errorText">No results found.</span>
                    <div class="progress-line"></div>
                </div>

                <div id="searchResults" class="mt-3"></div>
            </div>
        </div> --}}

        <!-- HTML: put this where your original row was -->
        <div class="row g-4 hide-dream">
            <div id="chapterDetailsCol" class="col-12">
                <section id="chapterDetailsCard" class="fade-in show section-box text-center">
                    <header class="section-header">
                        <span class="fw-semibold"> Chapter Details</span>
                    </header>
                    <div class="section-body scrollable p-4">
                        <div id="chapterDetails">
                            Please select a chapter to view its details.
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Second row: Words, Dreams, Description -->
        <div class="row g-4 mt-3" id="secondRow">
            <div id="wordsCol" class="col-lg-2" style="display:none;">
                <section id="wordsCard" class="fade-in section-box">
                    <header class="section-header">
                        <span class="fw-semibold">Choose Words</span>
                    </header>
                    <div class="section-body scrollable p-3">
                        <div id="words" class="d-flex flex-column gap-2 align-items-stretch"></div>
                    </div>
                </section>
            </div>

            <div id="dreamsCol" class="col-lg-4" style="display:none;">
                <section id="dreamsCard" class="fade-in section-box">
                    <header class="section-header">
                        <span class="fw-semibold">Choose Dreams</span>
                    </header>
                    <div class="section-body scrollable p-3">
                        <div id="dreams" class="d-flex flex-column gap-2 align-items-stretch"></div>
                    </div>
                </section>
            </div>

            <div id="descriptionCol" class="col-lg-6" style="display:none;">
                <section id="descriptionCard" class="fade-in section-box">
                    <header class="section-header">
                        <span class="fw-semibold">Description</span>
                    </header>
                    <div class="section-body scrollable p-3">
                        <div id="description"></div>
                    </div>
                </section>
            </div>
        </div>

    </div>

    @push('scripts')
        <script>
            const assetBase = "{{ asset('') }}";
        </script>

        <script>
            let data = {};
            const wordsDiv = document.getElementById("words");
            const dreamsDiv = document.getElementById("dreams");
            const descriptionDiv = document.getElementById("description");
            const chapterDetailsDiv = document.getElementById("chapterDetails");

            const wordsCol = document.getElementById("wordsCol");
            const chapterDetailsCol = document.getElementById("chapterDetailsCol");
            const dreamsCol = document.getElementById("dreamsCol");
            const descriptionCol = document.getElementById("descriptionCol");

            const chapterDetailsCard = document.getElementById("chapterDetailsCard");
            const wordsCard = document.getElementById("wordsCard");
            const dreamsCard = document.getElementById("dreamsCard");
            const descriptionCard = document.getElementById("descriptionCard");

            let selectedChapter = null;
            let selectedWord = null;
            let selectedDream = null;
            const projectFolder = ""; // leave empty or set if needed

            // ------------------ HELPERS ------------------
            function fadeIn(el) {
                if (el) {
                    el.style.display = "block";
                    requestAnimationFrame(() => el.classList.add("show"));
                }
            }

            function hide(el) {
                if (el) {
                    el.style.display = "none";
                    el.classList.remove("show");
                }
            }

            function highlightActive(container, activeBtn) {
                container.querySelectorAll("button").forEach(btn => btn.classList.remove("active"));
                if (activeBtn) activeBtn.classList.add("active");
            }

            function scrollToElement(el) {
                if (el) el.scrollIntoView({
                    behavior: "smooth",
                    block: "start"
                });
            }

            function getSlugFromURL() {
                const path = decodeURIComponent(window.location.pathname);
                const parts = path.split("/").filter(Boolean);
                if (parts.length >= 2) return {
                    type: parts[0],
                    slug: parts[1]
                };
                return null;
            }

            function updateURL(slug = "", type = "chapter") {
                const newURL = slug ? `${projectFolder}/${type}/${encodeURIComponent(slug)}` : `${projectFolder}/`;
                history.pushState({}, "", newURL);
            }

            // ------------------ LAYOUT ------------------
            function setLayout(state = "all") {
                if (state === "all") {
                    wordsCol.style.display = "none";
                    dreamsCol.style.display = "none";
                    descriptionCol.style.display = "none";
                    chapterDetailsCol.className = "col-12";
                } else if (state === "chapter") {
                    wordsCol.style.display = "block";
                    wordsCol.className = "col-lg-2 mb-3";
                    dreamsCol.style.display = "none";
                    descriptionCol.style.display = "none";
                    chapterDetailsCol.className = "col-lg-10 mb-3";
                } else if (state === "word") {
                    wordsCol.style.display = "block";
                    dreamsCol.style.display = "block";
                    descriptionCol.style.display = "block";
                    wordsCol.className = "col-lg-2 mb-3";
                    dreamsCol.className = "col-lg-4 mb-3";
                    descriptionCol.className = "col-lg-6 mb-3";
                }
            }

            // ------------------ BACK BUTTON ------------------
            function renderBackButton() {
                const existing = document.getElementById("backToChaptersWrapper");
                if (existing) existing.remove();

                const wrapper = document.createElement("div");
                wrapper.id = "backToChaptersWrapper";
                wrapper.className = "mt-4 text-center";
                wrapper.innerHTML = `
    <button id="backToChapters" class="btn btn-success px-4 py-2 fs-5">
      â¬… Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø­Ù„Ø§Ù… Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹
    </button>`;
                document.getElementById("secondRow").after(wrapper);

                document.getElementById("backToChapters").onclick = () => {
                    showAllChapterDetails();
                    updateURL("", "chapter");
                };
            }

            // ------------------ SHOW FUNCTIONS (modified) ------------------
            function showWords(chapter, highlightSlug = null) {
                setLayout("chapter");
                wordsDiv.innerHTML = "";
                let hasWords = false;

                const chapObj = data[chapter];
                if (!chapObj) {
                    wordsDiv.innerHTML = `<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ù…ÙˆØ² ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø§Ø¨.</div>`;
                    fadeIn(wordsCard);
                    renderBackButton();
                    return;
                }

                // Loop through keys in the chapter object
                Object.keys(chapObj).forEach(word => {
                    if (word === "chapter_details" || word === "chapter_slug") return;
                    const wordData = chapObj[word];
                    if (!wordData) return;

                    hasWords = true;
                    const btn = document.createElement("button");
                    btn.className = "btn btn-outline-success w-100 mb-2";
                    btn.textContent = word;

                    btn.onclick = function() {
                        highlightActive(wordsDiv, btn);
                        selectedWord = word;
                        selectedDream = null;
                        showDreams(chapter, word);
                        const slug = wordData.word_slug || word;
                        updateURL(slug, "word");
                    };

                    wordsDiv.appendChild(btn);

                    // autoâ€‘select if slug matches
                    if (highlightSlug && wordData.word_slug === highlightSlug) {
                        btn.click();
                    }
                });

                if (!hasWords) {
                    wordsDiv.innerHTML = `<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ù…ÙˆØ² ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø§Ø¨.</div>`;
                }

                fadeIn(wordsCard);
                renderBackButton();
            }

            function showDreams(chapter, word, highlightSlug = null) {
                setLayout("word");
                dreamsDiv.innerHTML = "";
                let hasDreams = false;

                const wordData = data[chapter] && data[chapter][word];
                if (!wordData) {
                    dreamsDiv.innerHTML = `<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ù„Ø§Ù… Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø².</div>`;
                    fadeIn(dreamsCard);
                    hide(descriptionCard);
                    return;
                }

                Object.keys(wordData).forEach(dreamKey => {
                    if (dreamKey === "word_slug") return;
                    const dreamObj = wordData[dreamKey];
                    if (!dreamObj) return;

                    hasDreams = true;
                    const btn = document.createElement("button");
                    btn.className = "btn btn-outline-success w-100 mb-2";
                    btn.textContent = dreamKey;

                    btn.onclick = function() {
                        highlightActive(dreamsDiv, btn);
                        selectedDream = dreamKey;
                        showDescription(chapter, word, dreamKey);
                        const slug = dreamObj.dream_slug || dreamKey;
                        updateURL(slug, "dream");
                    };

                    dreamsDiv.appendChild(btn);

                    // autoâ€‘select
                    if (highlightSlug && dreamObj.dream_slug === highlightSlug) {
                        btn.click();
                    }
                });

                if (!hasDreams) {
                    dreamsDiv.innerHTML = `<div class="alert alert-info">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø­Ù„Ø§Ù… Ù„Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø².</div>`;
                }

                fadeIn(dreamsCard);
                hide(descriptionCard);
            }

            function showDescription(chapter, word, dream) {
                const dreamObj = data[chapter] && data[chapter][word] && data[chapter][word][dream];
                const meaning = (dreamObj && dreamObj.meaning) ? dreamObj.meaning : "<em>Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙØ³ÙŠØ± Ù…ØªØ§Ø­.</em>";

                let adsHtml = "";
                if (data["_ads"] && Array.isArray(data["_ads"]) && data["_ads"].length) {
                    adsHtml = `
  <div class="mt-4">
    ${data["_ads"].map(ad => `
              <div class="p-3 mb-3 text-center border rounded bg-light" style="direction:rtl;">
                ${ad.url ? `
          <a href="${ad.link || '#'}" target="_blank">
            <img 
              src="${assetBase}${ad.url}" 
              alt="Ø¥Ø¹Ù„Ø§Ù†" 
              class="img-fluid rounded mb-2" 
              style="max-height:250px; object-fit:cover;"
            >
          </a>` 
                : ""}
                ${ad.text ? `<p class="mb-0">${ad.text}</p>` : ""}
              </div>
            `).join("")}
  </div>
`;
                }

                descriptionDiv.innerHTML = `
    <div class="p-4 mb-3 bg-white rounded shadow-sm" 
         style="direction:rtl; text-align:right; line-height:1.9;">
      ${meaning}
      ${adsHtml}
    </div>`;

                fadeIn(descriptionCard);
                renderBackButton();
                setTimeout(() => scrollToElement(descriptionCard), 300);
            }

            // (rest of your original functions unchanged) --

            function showAllChapterDetails() {
                setLayout("all");
                chapterDetailsDiv.innerHTML = Object.keys(data)
                    .filter(k => k !== "_ads")
                    .map(chapter => `
      <div class="chapter-item mb-3 p-3 border rounded" style="cursor:pointer; direction:rtl;" data-chapter="${chapter}">
        <h5>${chapter}</h5>
        <p class="mb-0">${data[chapter].chapter_details || "<em>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„ Ù…ØªØ§Ø­Ø©.</em>"}</p>
      </div>`).join("");

                document.querySelectorAll(".chapter-item").forEach(item => {
                    item.onclick = () => {
                        selectedChapter = item.dataset.chapter;
                        showSingleChapter(selectedChapter);
                        updateURL(data[selectedChapter].chapter_slug || selectedChapter, "chapter");
                    };
                });
            }

            function showSingleChapter(chapter) {
                setLayout("chapter");
                chapterDetailsDiv.innerHTML = `
    <div class="p-3 rounded border" style="direction:rtl;">
      <h5>${chapter}</h5>
      <p class="mb-0">${data[chapter].chapter_details || "<em>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„ Ù…ØªØ§Ø­Ø©.</em>"}</p>
    </div>`;
                showWords(chapter);
                renderBackButton();
            }

            function resolveSlugByValue(slug, type) {
                for (const chapter in data) {
                    if (type === "chapter" && data[chapter].chapter_slug === slug) {
                        showSingleChapter(chapter);
                        scrollToElement(chapterDetailsCard);
                        return;
                    }
                    for (const word in data[chapter]) {
                        if (["chapter_details", "chapter_slug"].includes(word)) continue;
                        if (!data[chapter][word]) continue;

                        if (type === "word" && data[chapter][word].word_slug === slug) {
                            showSingleChapter(chapter);
                            showWords(chapter, slug);
                            scrollToElement(wordsCard);
                            return;
                        }

                        for (const dream in data[chapter][word]) {
                            if (dream === "word_slug") continue;
                            if (type === "dream" && data[chapter][word][dream].dream_slug === slug) {
                                showSingleChapter(chapter);
                                showWords(chapter, data[chapter][word].word_slug);
                                showDreams(chapter, word, slug);
                                showDescription(chapter, word, dream);
                                scrollToElement(descriptionCard);
                                return;
                            }
                        }
                    }
                }
            }

            // INIT
            document.addEventListener("DOMContentLoaded", () => {
                fetch(`${projectFolder}/dream-data?action=data`)
                    .then(res => res.json())
                    .then(json => {
                        data = json;
                        console.log("Data loaded:", data);
                        const slugData = window.initialSlug || getSlugFromURL();
                        if (slugData) resolveSlugByValue(slugData.slug, slugData.type);
                        else showAllChapterDetails();
                    })
                    .catch(err => {
                        chapterDetailsDiv.innerHTML =
                        "<div class='text-danger'>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>";
                        console.error(err);
                    });
            });

            window.onpopstate = () => {
                const slugData = getSlugFromURL();
                slugData ? resolveSlugByValue(slugData.slug, slugData.type) : showAllChapterDetails();
            };
        </script>
    @endpush
